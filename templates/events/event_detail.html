{% extends "base.html" %}
{% block title %}{% if event.home_team %}{{ event.home_team.name }}{% else %}TBD{% endif %} vs {% if event.away_team %}{{ event.away_team.name }}{% else %}TBD{% endif %}{% endblock %}
{% block content %}
<a href="{% url 'events:event-list' %}" class="btn-secondary">&larr; Back to Event List</a>

<div class="detail-card">
    <h1>
        {% if event.home_team %}{{ event.home_team.name }}{% else %}TBD{% endif %}
        vs
        {% if event.away_team %}{{ event.away_team.name }}{% else %}TBD{% endif %}
    </h1>

    <p><strong>Status:</strong> {{ event.status|upper }}</p>
    <p><strong>Date:</strong> {{ event.start_datetime|date:"l, F j, Y" }} at {{ event.start_datetime|time:"P" }}</p>
    <p><strong>Season:</strong> {{ event.season|default:"N/A" }}</p>

    {% if event.stage %}
    <p>
        <strong>Competition:</strong>
        {{ event.stage.competition.sport.name }} |
        {{ event.stage.competition.name }}
        ({{ event.stage.name }})
    </p>
    {% endif %}

    {% if event.venue %}
        <p><strong>Venue:</strong> {{ event.venue.name }}</p>
    {% endif %}

    <hr>
    <h3>Result</h3>

    {% if event.status == 'played' %}
        <p><strong>Final Score:</strong> {{ event.home_goals|default:"N/A" }} - {{ event.away_goals|default:"N/A" }}</p>
        <p><strong>Winner:</strong> {% if event.winner %}{{ event.winner.name }}{% else %}N/A{% endif %}</p>
    {% else %}
        <div class="status-note">
            <p>Results are not yet available.</p>
            <p style="margin: 0; font-size: 1em;">
               To see or edit results, the event <strong>Status</strong>
               must be set to <strong>'Played'</strong>.
            </p>
        </div>
    {% endif %}

    {% if event.result_details %}
    <p style="margin-top: 1.5em;"><strong>Notes / Details:</strong></p>
    <pre style="background: #eee; padding: 1em; border-radius: 5px; white-space: pre-wrap; word-wrap: break-word;">{{ event.result_details }}</pre>
    {% endif %}
</div>

<div class="actions">
    <a href="{% url 'events:event-update' pk=event.pk %}" class="btn-primary">Edit Event / Update Results</a>
</div>
{% endblock %}